<!DOCTYPE html>
<html>
<head>
<title>AltSpace Particle Test</title>
<script src="http://sdk.altvr.com/libs/three.js/r73/build/three.js"></script>
<script src="http://sdk.altvr.com/libs/altspace.js/0.5.3/altspace.js"></script>
</head>
<body>
<script>

var animationInc = 0;

// Setup ThreeJS Scene for AltSpaceVR (Start)
var scene = new THREE.Scene();
var renderer = altspace.getThreeJSRenderer();
// Setup ThreeJS Scene for AltSpaceVR (End)

//Set up fire bounding box


// Creation of ThreeJS Cube (Start)
var geometry = new THREE.BoxGeometry(3, 3, 3);
var material = new THREE.MeshBasicMaterial({color:'#ffa500'});
var cube = new THREE.Mesh(geometry, material);
cube.scale.set(1, 3, 1);
cube.position.set(-1200, -400, 2);
scene.add(cube);

var cube1 = new THREE.Mesh(geometry, material);
cube1.scale.set(1, 3, 1);
cube1.position.set(-1220, -400, -3);
scene.add(cube1);

var cube2 = new THREE.Mesh(geometry, material);
cube2.scale.set(1, 3, 1);
cube2.position.set(-1190, -400, -2);
scene.add(cube2);

var cube3 = new THREE.Mesh(geometry, material);
cube3.scale.set(1, 3, 1);
cube3.position.set(-1170, -400, 1);
scene.add(cube3);

var cube4 = new THREE.Mesh(geometry, material);
cube4.scale.set(1, 3, 1);
cube4.position.set(-1175, -400, 5);
scene.add(cube4);

var cube5 = new THREE.Mesh(geometry, material);
cube5.scale.set(1, 3, 1);
cube5.position.set(-1185, -400, 2);
scene.add(cube5);
// Creation of ThreeJS Cube (End)


var particleCount = 10,
	particles = new THREE.Geometry(),
	pMaterial = new THREE.ParticleBasicMaterial({
		color: 0xFFFFFF,
		size:20
	});
	
for (var p = 0; p < particleCount; p++) {
	
	//Create a particle with random position values, -250-250
	var pX = Math.random() * 500 - 250;
	var pY = Math.random() * 500 - 250;
	var	pZ = Math.random() * 500 - 250;
	var	particle = new THREE.Vertex( new THREE.Vector3(pX, pY, pZ) );
	particles.vertices.push(particle);
}

//create the particle system
var particleSystem = new THREE.ParticleSystem(
	particles,
	pMaterial);
	
scene.addChild(particleSystem);


// Start AltSpaceVR Render (Start)
function animate() {
	animationInc++;
	requestAnimationFrame(animate);
	AnimateFunction();
	renderer.render(scene);
}
animate();
// Start AltSpaceVR Render (End)

function AnimateFunction() {
	//move particles up, and reset particles when they leave the box, 
    if (cube.position.y > -100) {cube.position.y = -400;} else {cube.position.y += 2.8;}
	if (cube1.position.y > -100) {cube1.position.y = -400;} else {cube1.position.y += 2.3;}
	if (cube2.position.y > -100) {cube2.position.y = -400;} else {cube2.position.y += 2.0;}
	if (cube3.position.y > -100) {cube3.position.y = -400;} else {cube3.position.y += 1.8;}
	if (cube4.position.y > -100) {cube4.position.y = -400;} else {cube4.position.y += 1.7;}	
	if (cube5.position.y > -100) {cube5.position.y = -400;} else {cube5.position.y += 2.7;}	
	
	
	//step the side to side animation
	cube.position.x += Math.sin(animationInc/20);
	cube.position.z += Math.sin(animationInc/25);
	cube1.position.x += Math.sin(animationInc/19);
	cube1.position.z += Math.sin(animationInc/22);
	cube2.position.x += Math.sin(animationInc/26);
	cube2.position.z += Math.sin(animationInc/28);
	cube3.position.x += Math.sin(animationInc/29);
	cube3.position.z += Math.sin(animationInc/23.5);
	cube4.position.x += Math.sin(animationInc/30);
	cube4.position.z += Math.sin(animationInc/32);
	cube5.position.x += Math.sin(animationInc/31.5);
	cube5.position.z += Math.sin(animationInc/24.5);
}

</script>
</body>
</html> 